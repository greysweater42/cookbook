---
title: "RMariaDB (former RMySQL)"
date: 2018-02-12T12:17:56+01:00
draft: false
image: "RMariaDB.jpg"
categories: ["R"]
tags: ["R", "SQL"]
---



<div id="what-is-rmariadb-and-why-would-you-use-it" class="section level2">
<h2>1. What is RMariaDB and why would you use it?</h2>
<ul>
<li><code>RMariaDB</code> is an R package available at CRAN that letâ€™s you connect to various SQL databases easily.</li>
</ul>
<p>Why did I switch from RMySQL to RMariaDB? Because of invalid long integer format when downloading data from a database. A pretty nasty bug in RMySQL, which was resolved in RMariaDB.</p>
</div>
<div id="usage" class="section level2">
<h2>2. Usage</h2>
<p>First you have to create a connection to the database. Remember that you should not provide any credentials in your scripts! Keep them in a separate file or in envorionment variables.</p>
<pre class="r"><code>con &lt;- RMariaDB::dbConnect(
  drv      = RMariaDB::MariaDB(), 
  user     = &quot;&quot;,
  password = &quot;&quot;,
  host     = &quot;&quot;, 
  dbname   = &quot;&quot;
)</code></pre>
<p>After you are done with working on your database data, you should close the connection with:</p>
<pre class="r"><code>RMariaDB::dbDisconnect(con)</code></pre>
<div id="a-using-plain-r" class="section level3">
<h3>a) using plain R</h3>
<ul>
<li><h3 id="just-querying">just querying</h3></li>
</ul>
<pre class="r"><code>query &lt;- &quot;delete from my_table;&quot;

RMariaDB::dbSendQuery(con, query)</code></pre>
<ul>
<li><h3 id="retrieving-data-from-db">retrieving data from db</h3></li>
</ul>
<pre class="r"><code>query &lt;- &quot;select * from my_table;&quot;

rs &lt;- RMariaDB::dbSendQuery(con, query)
tab &lt;- RMariaDB::dbFetch(rs, n = -1)
RMariaDB::dbClearResult(rs)

# equivalent to select * from my_table;
d &lt;- RMariaDB::dbReadTable(con, &quot;my_table&quot;)</code></pre>
<ul>
<li><h3 id="sending-data-to-db">sending data to db</h3></li>
</ul>
<pre class="r"><code># data.frame&#39;s colnames should be the same as in the database
dt &lt;- data.frame(id = 1:10, text = letters[1:10])

RMariaDB::dbWriteTable(
  conn = con, 
  name = &quot;my_table&quot;, 
  value = dt, 
  overwrite = FALSE,
  append = TRUE,
  row.names = F
)</code></pre>
</div>
<div id="b-using-dplyr" class="section level3">
<h3>b) using <a href="http://tomis9.com/tidyverse/#/dplyr">dplyr</a></h3>
<ul>
<li><h4 id="just-querying-retrieving-data-from-db">just querying / retrieving data from db</h4></li>
</ul>
<pre class="r"><code>tab_name &lt;- dplyr::tbl(con, &quot;tab_name&quot;)
tab &lt;- dplyr::collect(tab_name)  # you can `library(dplyr)` and then `tab_name %&gt;% collect()`</code></pre>
<ul>
<li><h3 id="sending-data-to-db-1">sending data to db</h3></li>
</ul>
<pre class="r"><code>dplyr::db_insert_into(con, &quot;my_table&quot;, tab)</code></pre>
</div>
</div>
<div id="useful-links" class="section level2">
<h2>3. Useful links</h2>
<ul>
<li><a href="https://github.com/r-dbi/RMariaDB">github page with an informative README</a></li>
<li><a href="https://cran.r-project.org/web/packages/RMariaDB/README.html">cran README</a></li>
</ul>
</div>
