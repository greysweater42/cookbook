---
title: "Rcpp"
date: 2018-02-04T12:03:14+01:00
draft: false
image: "Rcpp.jpg"
categories: ["R"]
tags: ["R", "C++"]
---



<div id="what-is-rcpp-and-why-would-you-use-it" class="section level2">
<h2>1. What is Rcpp and why would you use it?</h2>
<ul>
<li><p><code>Rcpp</code> is a R library which let’s you embed C++ code inside your R program.</p></li>
<li><p>Useful when you have a bottleneck in your code which makes the execution last forever. In that case you can rewrite in into super-fast C++.</p></li>
</ul>
<p>Or you can switch to Python. Or data.table. Or write it in <a href="http://tomis9.com/cinr">C</a>.</p>
</div>
<div id="a-hello-world-example" class="section level2">
<h2>2. A “Hello World” example</h2>
<p>Example taken from Avanced R by Hadley Wickam <a href="http://adv-r.had.co.nz/Rcpp.html">(link)</a>.</p>
<pre class="r"><code>library(Rcpp)</code></pre>
<p>So far so good. This is how we create a C++ function <code>add</code>:</p>
<pre class="r"><code>cppFunction(&#39;int add(int x, int y, int z) {
  int sum = x + y + z;
  return sum;
}&#39;)</code></pre>
<p>and invoke it:</p>
<pre class="r"><code>add(1, 2, 3)</code></pre>
<pre><code>## [1] 6</code></pre>
<p>You can check that this actually is a C++ function simply by:</p>
<pre class="r"><code>add</code></pre>
<pre><code>## function (x, y, z) 
## .Call(&lt;pointer: 0x7f76c1351e30&gt;, x, y, z)</code></pre>
</div>
<div id="using-rs-numeric-vector-as-input-and-output" class="section level2">
<h2>3. Using R’s numeric vector as input and output</h2>
<p>A slighlty more complicated function, which calculates a distance between a value and a vector of values:</p>
<pre class="r"><code>cppFunction(&#39;NumericVector pdistC(double x, NumericVector ys) {
  int n = ys.size();
  NumericVector out(n);

  for(int i = 0; i &lt; n; ++i) {
    out[i] = sqrt(pow(ys[i] - x, 2.0));
  }
  return out;
}&#39;)</code></pre>
<p>And let’s run this function:</p>
<pre class="r"><code>pdistC(10, c(11, -12, 30))</code></pre>
<pre><code>## [1]  1 22 20</code></pre>
</div>
